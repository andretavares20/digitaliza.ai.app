import{a as Ee}from"./chunk-Y4G5GUBV.js";import{a as De,b as Ie}from"./chunk-JGDHNRTM.js";import"./chunk-RMFINLED.js";import{a as ke,b as Ve}from"./chunk-3P66YKNC.js";import{a as R}from"./chunk-TOYKGQGS.js";import{k as Ce}from"./chunk-KG7YTVHA.js";import"./chunk-NVGTPZR2.js";import"./chunk-ATI5C2A4.js";import{b as he}from"./chunk-SWT3BTO7.js";import"./chunk-J4AIIC6A.js";import"./chunk-Q2ITSG2L.js";import"./chunk-KPXVOOCJ.js";import"./chunk-TNABXVKL.js";import{a as xe,b as Se}from"./chunk-6Z3H2M45.js";import"./chunk-VLJCDE2P.js";import{b as Me,d as Pe,f as Oe,g as we}from"./chunk-QVONU2JU.js";import{b as be}from"./chunk-CKGIWHXC.js";import{b as ye}from"./chunk-3Y45ZQMX.js";import{b as ue}from"./chunk-PAKM22Z6.js";import{i as ge,l as ve}from"./chunk-RXT5QTRP.js";import"./chunk-CM56NBY7.js";import"./chunk-YRMYVX5W.js";import"./chunk-XSHLOVSR.js";import"./chunk-KRKZIUB7.js";import{a as fe,b as _e}from"./chunk-4RWBCLJX.js";import"./chunk-T22KTX4I.js";import"./chunk-YUR3ZCTK.js";import"./chunk-O6DKXQN7.js";import"./chunk-36GPJXQ3.js";import"./chunk-UHFSMSZS.js";import"./chunk-ATZD6M4U.js";import{b as ce,d as de,e as pe,h as me}from"./chunk-3ZIDJAHB.js";import"./chunk-XSSXK7EZ.js";import{A as le,i as T,n as ie,y as ae,z as se}from"./chunk-CCYSFV2Z.js";import{Cb as ne,Da as k,Ea as _,Fa as v,Fb as oe,Hb as N,I as M,Ia as Q,La as q,M as b,Ma as J,N as P,Na as Z,Oa as K,Pa as m,Qa as V,Ra as j,S as u,Sa as X,T as g,Ta as D,U as z,Ua as I,Va as E,Vb as re,Wa as Y,Ya as B,Yb as F,aa as U,ca as w,da as d,e as L,ea as x,fb as O,hb as y,oa as C,pa as S,qa as f,ra as H,sa as G,ta as A,xa as i,xb as $,ya as a,yb as ee,za as h,zb as te}from"./chunk-EOM5JP26.js";var Ne=(()=>{class n{styleClass;style;strokeWidth="2";fill="none";animationDuration="2s";static \u0275fac=function(t){return new(t||n)};static \u0275cmp=b({type:n,selectors:[["p-progressSpinner"]],hostAttrs:[1,"p-element"],inputs:{styleClass:"styleClass",style:"style",strokeWidth:"strokeWidth",fill:"fill",animationDuration:"animationDuration"},decls:3,vars:10,consts:[["role","progressbar",1,"p-progress-spinner",3,"ngStyle","ngClass"],["viewBox","25 25 50 50",1,"p-progress-spinner-svg"],["cx","50","cy","50","r","20","stroke-miterlimit","10",1,"p-progress-spinner-circle"]],template:function(t,o){t&1&&(i(0,"div",0),z(),i(1,"svg",1),h(2,"circle",2),a()()),t&2&&(f("ngStyle",o.style)("ngClass",o.styleClass),S("aria-busy",!0)("data-pc-name","progressspinner")("data-pc-section","root"),d(),H("animation-duration",o.animationDuration),S("data-pc-section","root"),d(),S("fill",o.fill)("stroke-width",o.strokeWidth))},dependencies:[$,ne],styles:[`@layer primeng{.p-progress-spinner{position:relative;margin:0 auto;width:100px;height:100px;display:inline-block}.p-progress-spinner:before{content:"";display:block;padding-top:100%}.p-progress-spinner-svg{animation:p-progress-spinner-rotate 2s linear infinite;height:100%;transform-origin:center center;width:100%;position:absolute;inset:0;margin:auto}.p-progress-spinner-circle{stroke-dasharray:89,200;stroke-dashoffset:0;stroke:#d62d20;animation:p-progress-spinner-dash 1.5s ease-in-out infinite,p-progress-spinner-color 6s ease-in-out infinite;stroke-linecap:round}}@keyframes p-progress-spinner-rotate{to{transform:rotate(360deg)}}@keyframes p-progress-spinner-dash{0%{stroke-dasharray:1,200;stroke-dashoffset:0}50%{stroke-dasharray:89,200;stroke-dashoffset:-35px}to{stroke-dasharray:89,200;stroke-dashoffset:-124px}}@keyframes p-progress-spinner-color{to,0%{stroke:#d62d20}40%{stroke:#0057e7}66%{stroke:#008744}80%,90%{stroke:#ffa700}}
`],encapsulation:2,changeDetection:0})}return n})(),Te=(()=>{class n{static \u0275fac=function(t){return new(t||n)};static \u0275mod=P({type:n});static \u0275inj=M({imports:[N]})}return n})();var We=["fileInput"],ze=()=>({width:"450px"}),Ue=()=>({width:"50px",height:"50px",position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)"});function He(n,r){n&1&&(i(0,"div",21)(1,"div",22),m(2," LARGUE A IMAGEM AQUI "),a()())}function Ge(n,r){if(n&1){let l=k();i(0,"p-checkbox",29),E("ngModelChange",function(o){let e=u(l).$implicit,s=v().$implicit;return I(s.services[e.name],o)||(s.services[e.name]=o),g(o)}),_("onChange",function(){u(l);let o=v(3);return g(o.calculateValue())}),a()}if(n&2){let l=r.$implicit,t=v().$implicit;D("ngModel",t.services[l.name]),f("label",l.name)}}function Qe(n,r){if(n&1){let l=k();i(0,"li"),h(1,"img",25),i(2,"span"),m(3),a(),i(4,"button",26),_("click",function(){let o=u(l).index,e=v(2);return g(e.removeFile(o))}),a(),i(5,"div",27),C(6,Ge,1,2,"p-checkbox",28),a()()}if(n&2){let l=r.$implicit,t=v(2);d(),Q("alt",l.file.name),f("src",l.objectURL,U),d(2),X("",l.file.name," - ",l.file.size," bytes"),d(3),f("ngForOf",t.servicos)}}function qe(n,r){if(n&1&&(i(0,"div",23)(1,"ul"),C(2,Qe,7,5,"li",24),a()()),n&2){let l=v();d(2),f("ngForOf",l.newOrder.files)}}function Je(n,r){if(n&1&&(i(0,"div")(1,"p"),m(2,"Cupom aplicado: "),i(3,"strong"),m(4),a()(),i(5,"p"),m(6,"Valor original: "),i(7,"span",30),m(8),O(9,"currency"),a()(),i(10,"p"),m(11,"Valor com desconto: "),i(12,"strong"),m(13),O(14,"currency"),a()()()),n&2){let l=v();d(4),V(l.couponCode),d(4),V(y(9,3,l.originalValue,"BRL")),d(5),V(y(14,6,l.newOrder.value,"BRL"))}}function Ze(n,r){n&1&&h(0,"p-progressSpinner",31),n&2&&A(B(2,Ue))}var Le=(()=>{let r=class r{constructor(t,o,e){this.servicoService=t,this.router=o,this.messageService=e,this.isDragging=!1,this.isLoading=!1,this.orderSummaryDialog=!1,this.couponCode="",this.discount=0,this.couponApplied=!1,this.originalValue=0,this.servicos=[],this.newOrder={files:[],services:{},observations:"",value:0,orderDate:new Date,deliveryDate:null,resultUrl:""},this.preferenceId=""}ngOnInit(){this.loadServicos()}loadServicos(){this.servicoService.getServicos().subscribe(t=>{this.servicos=t})}onFileSelected(t){let o=t.target.files;for(let e of o){let s=URL.createObjectURL(e);this.newOrder.files.push({file:e,objectURL:s,services:{}}),this.servicos.forEach(c=>{this.newOrder.files[this.newOrder.files.length-1].services[c.name]=!1})}this.calculateValue()}removeFile(t){this.newOrder.files.splice(t,1),this.calculateValue()}onDragOver(t){t.preventDefault(),this.isDragging=!0}onDragLeave(t){t.target===document.body&&(this.isDragging=!1)}onDrop(t){t.preventDefault(),this.isDragging=!1;let o=t.dataTransfer.files;for(let e of o){let s=URL.createObjectURL(e);this.newOrder.files.push({file:e,objectURL:s,services:{}}),this.servicos.forEach(c=>{this.newOrder.files[this.newOrder.files.length-1].services[c.name]=!1})}this.calculateValue()}calculateValue(){let t=this.newOrder.files.reduce((o,e)=>{let s=Object.keys(e.services).reduce((c,p)=>{let je=this.servicos.find(Be=>Be.name===p);return c+(e.services[p]?je.price:0)},0);return o+s},0);this.couponApplied||(this.originalValue=t),this.newOrder.value=t-this.discount}applyCoupon(){if(this.newOrder.value<=0){this.messageService.add({severity:"error",summary:"Erro",detail:"O valor total deve ser maior que zero para aplicar um cupom."});return}if(this.couponApplied){this.messageService.add({severity:"error",summary:"Erro",detail:"Cupom j\xE1 aplicado."});return}this.couponCode==="DIGITALIZEAI10"?(this.discount=this.originalValue*.1,this.couponApplied=!0,this.messageService.add({severity:"success",summary:"Cupom aplicado",detail:"10% de desconto aplicado!"})):(this.discount=0,this.messageService.add({severity:"error",summary:"Erro",detail:"Cupom inv\xE1lido."})),this.calculateValue()}openOrderSummary(){if(this.isLoading=!0,this.newOrder.value<=0){this.messageService.add({severity:"error",summary:"Erro",detail:"O valor total deve ser maior que zero."}),this.isLoading=!1;return}this.createCheckoutButton(),this.orderSummaryDialog=!0}createCheckoutButton(){return L(this,null,function*(){try{let t=yield R.get("http://localhost:3000/create_preference");this.preferenceId=t.data.preferenceId,yield new window.MercadoPago("TEST-a45e1791-b190-4123-843b-7a4376e382bd").bricks().create("wallet","wallet_container",{initialization:{preferenceId:this.preferenceId},customization:{texts:{valueProp:"smart_option"}}}),yield this.updatePreference(),this.isLoading=!1}catch(t){console.error("Error creating preference:",t),this.isLoading=!1}})}updatePreference(){return L(this,null,function*(){try{yield R.post("http://localhost:3000/update_preference",{preferenceId:this.preferenceId,totalValue:this.newOrder.value})}catch(t){console.error("Error updating preference:",t),this.messageService.add({severity:"error",summary:"Erro",detail:"N\xE3o foi poss\xEDvel atualizar a prefer\xEAncia."})}})}};r.\u0275fac=function(o){return new(o||r)(x(Ee),x(re),x(T))},r.\u0275cmp=b({type:r,selectors:[["app-novo-pedido"]],viewQuery:function(o,e){if(o&1&&q(We,5),o&2){let s;J(s=Z())&&(e.fileInput=s.first)}},hostBindings:function(o,e){o&1&&_("dragover",function(c){return e.onDragOver(c)},!1,w)("dragleave",function(c){return e.onDragLeave(c)},!1,w)("drop",function(c){return e.onDrop(c)},!1,w)},features:[Y([T])],decls:43,vars:22,consts:[["fileInput",""],[1,"novo-pedido-container"],["class","overlay",4,"ngIf"],[1,"card"],[1,"upload-area",3,"dragover","drop","dragleave"],[1,"drag-drop-area"],[1,"upload-actions"],["pButton","","label","Escolha a imagem para vetorizar",3,"click"],["type","file","multiple","",2,"display","none",3,"change"],["class","uploaded-files",4,"ngIf"],[1,"p-field"],["for","coupon"],["id","coupon","type","text","pInputText","",3,"ngModelChange","ngModel","disabled"],["pButton","","label","Aplicar Cupom",3,"click","disabled"],[4,"ngIf"],["pButton","","label","Avan\xE7ar","icon","pi pi-check",3,"click"],["header","Confirma\xE7\xE3o do Pedido",3,"visibleChange","visible","modal"],["ariaLabel","loading",3,"style",4,"ngIf"],[1,"p-fluid"],["id","wallet_container"],["label","Cancelar","icon","pi pi-times",1,"p-button-text",3,"click"],[1,"overlay"],[1,"overlay-content"],[1,"uploaded-files"],[4,"ngFor","ngForOf"],[1,"thumbnail",3,"src","alt"],["pButton","","icon","pi pi-times",1,"remove-btn",3,"click"],[1,"services"],["binary","true",3,"ngModel","label","ngModelChange","onChange",4,"ngFor","ngForOf"],["binary","true",3,"ngModelChange","onChange","ngModel","label"],[2,"text-decoration","line-through"],["ariaLabel","loading"]],template:function(o,e){if(o&1){let s=k();i(0,"div",1),C(1,He,3,0,"div",2),i(2,"div",3)(3,"h2"),m(4,"Rastreie pixels para vetores em full color"),a(),i(5,"p"),m(6,"Converta suas imagens PNG e JPG para vetores CorelDRAW e PDF"),a(),i(7,"div",4),_("dragover",function(p){return u(s),g(e.onDragOver(p))})("drop",function(p){return u(s),g(e.onDrop(p))})("dragleave",function(p){return u(s),g(e.onDragLeave(p))}),i(8,"div",5)(9,"span"),m(10,"ARRASTE A IMAGEM AQUI PARA COME\xC7AR"),a()()(),i(11,"div",6)(12,"span"),m(13,"ou"),a(),i(14,"button",7),_("click",function(){u(s);let p=K(16);return g(p.click())}),a(),i(15,"input",8,0),_("change",function(p){return u(s),g(e.onFileSelected(p))}),a(),i(17,"span"),m(18,"ou pressione CTRL + V"),a()(),C(19,qe,3,1,"div",9),i(20,"div",10)(21,"label",11),m(22,"Cupom de Desconto"),a(),i(23,"input",12),E("ngModelChange",function(p){return u(s),I(e.couponCode,p)||(e.couponCode=p),g(p)}),a(),i(24,"button",13),_("click",function(){return u(s),g(e.applyCoupon())}),a()(),C(25,Je,15,9,"div",14),i(26,"h5"),m(27),O(28,"currency"),a(),i(29,"button",15),_("click",function(){return u(s),g(e.openOrderSummary())}),a()()(),i(30,"p-dialog",16),E("visibleChange",function(p){return u(s),I(e.orderSummaryDialog,p)||(e.orderSummaryDialog=p),g(p)}),C(31,Ze,1,3,"p-progressSpinner",17),i(32,"div",18)(33,"div",10)(34,"h4"),m(35,"Resumo do Pedido"),a(),i(36,"p"),m(37),O(38,"currency"),a(),h(39,"div",19),a()(),i(40,"p-footer")(41,"p-button",20),_("click",function(){return u(s),g(e.orderSummaryDialog=!1)}),a()()(),h(42,"p-toast")}o&2&&(d(),f("ngIf",e.isDragging),d(18),f("ngIf",e.newOrder.files.length),d(4),D("ngModel",e.couponCode),f("disabled",e.couponApplied),d(),f("disabled",e.couponApplied||e.newOrder.value<=0),d(),f("ngIf",e.couponApplied),d(2),j("Valor Total: ",y(28,15,e.newOrder.value,"BRL"),""),d(3),A(B(21,ze)),D("visible",e.orderSummaryDialog),f("modal",!0),d(),f("ngIf",e.isLoading),d(),G("blurred",e.isLoading),d(5),j("Valor Total: ",y(38,18,e.newOrder.value,"BRL"),""))},dependencies:[ee,te,ce,de,pe,ie,ae,se,fe,De,xe,Ne,ke,oe],styles:[".novo-pedido-container[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;flex-direction:column;min-height:100vh}.novo-pedido-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{width:80%;max-width:800px;padding:2rem;box-shadow:0 2px 10px #0000001a;border-radius:8px;text-align:center}.novo-pedido-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:2rem;margin-bottom:1rem}.novo-pedido-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1rem;margin-bottom:1rem}.novo-pedido-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .upload-area[_ngcontent-%COMP%]{margin:2rem 0;border:2px dashed #ccc;padding:4rem;border-radius:8px;display:flex;align-items:center;justify-content:center;position:relative;height:200px}.novo-pedido-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .upload-area[_ngcontent-%COMP%]:hover{background-color:#f9f9f9;opacity:5%}.novo-pedido-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .upload-area[_ngcontent-%COMP%]   .drag-drop-area[_ngcontent-%COMP%]{text-align:center}.novo-pedido-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .upload-actions[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;margin-top:1rem}.novo-pedido-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .upload-actions[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin:0 .5rem}.novo-pedido-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .upload-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:150px;border-radius:25px;margin:0 .5rem;padding:.5rem 1rem;background-color:#007bff;color:#fff;border:none;cursor:pointer}.novo-pedido-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .upload-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#0056b3}.novo-pedido-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .uploaded-files[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:1rem}.novo-pedido-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .uploaded-files[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style-type:none;padding:0}.novo-pedido-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .uploaded-files[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:.5rem;font-size:.9rem;display:flex;align-items:center}.novo-pedido-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .uploaded-files[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .thumbnail[_ngcontent-%COMP%]{width:50px;height:50px;object-fit:cover;border-radius:8px;margin-right:.5rem}.novo-pedido-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .uploaded-files[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{flex-grow:1;margin-left:.5rem}.novo-pedido-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .uploaded-files[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .remove-btn[_ngcontent-%COMP%]{background:none;border:none;color:red;cursor:pointer}.novo-pedido-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .uploaded-files[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .remove-btn[_ngcontent-%COMP%]:hover{color:#c00}.novo-pedido-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .services[_ngcontent-%COMP%]{display:flex;justify-content:center;margin:1rem 0}.novo-pedido-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .services[_ngcontent-%COMP%]   p-checkbox[_ngcontent-%COMP%]{margin-right:1rem}.novo-pedido-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .services[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-right:2rem}.novo-pedido-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .p-field[_ngcontent-%COMP%]{margin-top:2rem}.novo-pedido-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .p-field[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%}.novo-pedido-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-top:2rem;width:100%;padding:.75rem;border-radius:50px;background-color:#007bff;color:#fff;border:none;cursor:pointer}.novo-pedido-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#0056b3}.novo-pedido-container[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#ffffffe6;display:flex;justify-content:center;align-items:center;z-index:1000}.novo-pedido-container[_ngcontent-%COMP%]   .overlay[_ngcontent-%COMP%]   .overlay-content[_ngcontent-%COMP%]{font-size:2rem;color:#333;font-weight:700}.blurred[_ngcontent-%COMP%]{filter:blur(5px);pointer-events:none;-webkit-user-select:none;user-select:none}"]});let n=r;return n})();var Ae=(()=>{let r=class r{};r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=P({type:r}),r.\u0275inj=M({imports:[F.forChild([{path:"",component:Le}]),F]});let n=r;return n})();var Lt=(()=>{let r=class r{};r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=P({type:r}),r.\u0275inj=M({imports:[N,me,Ae,Me,ue,Pe,ge,Oe,ve,we,ye,be,_e,Ce,le,Ie,he,Se,Te,Ve]});let n=r;return n})();export{Lt as NovoPedidoModule};
